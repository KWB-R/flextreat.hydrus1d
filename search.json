[{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_python.html","id":"install-r-package","dir":"Articles","previous_headings":"","what":"Install R Package","title":"Modelling with Python","text":"","code":"# Enable this universe options(repos = c(   kwbr = 'https://kwb-r.r-universe.dev',   CRAN = 'https://cloud.r-project.org')) # Install R package install.packages('flextreat.hydrus1d')"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_python.html","id":"install-phython-package-phydrus","dir":"Articles","previous_headings":"","what":"Install Phython Package phydrus","title":"Modelling with Python","text":"","code":"is_windows <- Sys.info()[1] == \"Windows\"  library(flextreat.hydrus1d)  ### Compile Hydrus1D v4.08 for windows  ### based on: https://github.com/phydrus/source_code/tree/main/source if(is_windows) {   exe_path <- flextreat.hydrus1d::create_hydrus_exe()   writeLines(exe_path, \"exe_path.txt\") }  env <- \"flextreat\"  kwb.python::conda_py_install(env_name = env,                               pkgs = list(conda=c(\"python=3.9\", \"openpyxl\"),                                          py = \"https://github.com/phydrus/phydrus/zipball/dev/79823e797662b9838dda13888e3ead962c6699d0\"))  reticulate::use_miniconda(condaenv = env, required = TRUE)  tdir <- tempdir() fs::dir_create(tdir) env_yml <- kwb.python::conda_export(condaenv = env, export_dir = tdir) file.copy(env_yml, basename(env_yml), overwrite = TRUE)  #For reproducing the Python environment used for the `Hydrus1D` modelling you can  #check the `env_yml` file. Keep in mind that `phydrus` was developed #for the last open-source release (`hydrus v4.0.8`) and is not compatible with the  #latest `hydrus v4.17.0140` (see: #https://github.com/phydrus/source_code/issues/1#issuecomment-1034675697). env_yml                             data(atmosphere) write.csv(atmosphere, file = \"atmosphere.csv\", row.names = FALSE) # Import the necessary modules import os  import numpy as np import pandas as pd  import matplotlib as mpl import matplotlib.pyplot as plt  import phydrus as ps   ############################################################################### # 0 General Model Settings ############################################################################### exe_path = open(\"exe_path.txt\").read().splitlines() exe_path = ''.join(exe_path) exe_path   ml = ps.model.Model(exe_name = exe_path,                     ws_name = \"test\",                     name = \"Test\",                     description = \"Test for FlexTreat\",                     length_unit = \"cm\",                     time_unit = \"days\",                     mass_units = \"mmol\",                     print_screen = True)                                           ml.add_time_info(   tinit = 0, #Initial time of the simulation [T].   tmax = 2, #Final time of the simulation [T].   print_times = True     #Set to True. if information of pressure head, water contents,     #temperatures, and concentrations in observation nodes, and     #the water and solute fluxes is to be printed at a constant     #time interval of 1 time unit.   )    ml.add_waterflow(   top_bc = 3, #Upper Boundary Condition:     #0 = Constant Pressure Head.     #1 = Constant Flux.     #2 = Atmospheric Boundary Condition with Surface Layer.     #3 = Atmospheric Boundary Condition with Surface Run Off.     #4 = Variable Pressure Head.     #5 = Variable Pressure Head/Flux.   bot_bc = 4 #Lower Boundary Condition:     #0 = Constant Pressure Head.     #1 = Constant Flux.     #2 = Variable Pressure Head.     #3 = Variable Flux.     #4 = Free Drainage.     #5 = Deep Drainage.     #6 = Seepage Face.     #7 = Horizontal Drains.   )  ## Add the process solute transport # ml.add_solute_transport( #   lupw = True #   )  # Add materials m = ml.get_empty_material_df(n=2) m.loc[0:2] = [[0.0449, 0.3833, 0.0385, 3.2783, 619.18, 0.5],               [0.04985, 0.377475, 0.03485, 3.8696, 1188.05, 0.5]] ml.add_material(m)  profile = ps.create_profile(   top = 0, #float, optional     #Top of the soil column.   bot = [-60, -200], #float or list of float, optional     #Bottom of the soil column. If a list is provided, multiple layers are     #created and other arguments need to be of the same length (e.g. mat).   dx = 1, #float, optional     #Size of each grid cell   h = -500, # float, optional     #Initial values of the pressure head.   lay = [1,2], #int or list of int, optional     #Subregion number (for mass balance calculations).   mat = [1,2], #int or list of int, optional     #Material number (for heterogeneity).   conc = 1e-10 #float, option   )  ml.add_profile(profile)  ml.add_obs_nodes(   depths = [-30, -60, -90, -120, -160, -200] #list of ints     #List of floats denoting the depth of the nodes. The depth is     #defined in the same length unit as selected in ml.model function.     #The function defines the closest node to the desired depth.   )  # sol = ml.get_empty_solute_df() # sol.loc[:, \"beta\"] = 1.0 # ml.add_solute( #   data = sol, #   difw = 1e-9, #float, optional #     #Ionic or molecular diffusion coefficient in free water, Dw [L2T-1]. #   difg = 0 #float, optional #     #Ionic or molecular diffusion coefficient in gas phase, Dg [L2T-1] #   )  atm = pd.read_csv(\"atmosphere.csv\", index_col=0) atm[\"cBot\"] = 0.0 atm[\"cTop\"] = 0.0 atm.loc[1, \"cTop\"] = 1.0 atm[0:2] ml.add_atmospheric_bc(   atmosphere = atm[0:2], #pandas.DataFrame     #Pandas DataFrame with at least the following columns: tAtm,     #Prec, rSoil, rRoot, hCritA, rB, hB, hT, tTop, tBot, and Ampl.   ldailyvar = False, #bool, optional     #True if HYDRUS-1D is to generate daily variations in evaporation     #and transpiration. False otherwise.   lsinusvar = False, #bool, optional     #True if HYDRUS-1D is to generate sinusoidal variations in     #precipitation. False otherwise.   llai = False, #bool, optional     #Boolean indicating that potential evapotranspiration is     #to be divided into potential evaporation and potential     #transpiration using eq. (2.75) of the manual.   rextinct = 0.463, #float, optional     #A constant for the radiation extinction by the canopy     #(rExtinct=0.463) [-]. only used when lLai is True.   hcrits = 0, #float, optional     #Maximum allowed pressure head at the soil surface [L]. Default is     #1e+30.   tatm = 0, #float, optional     #Time for which the i-th data record is provided [T].   hcrita = 100000.0, #float, optional     #Absolute value of the minimum allowed pressure head at the soil     #surface [L].   rb = 0, #float, optional     #Bottom flux [LT-1] (set equal to 0 if KodBot is positive, or if     #one of the logical variables qGWLF, FreeD or SeepF is .true.).   hb = 0, #float, optional     #Groundwater level [L], or any other prescribed pressure head     #boundary condition as indicated by a positive value of KodBot     #(set equal to 0 if KodBot is negative, or if one of the logical     #variables qGWLF, FreeD or SeepF is .true.).   ht = 0,  #float, optional     #Prescribed pressure head [L] at the surface (set equal to 0 if     #KodBot is negative).   ttop = 0, #float, optional     #Soil surface temperature [oC] (omit if both lTemp and lChem are     #equal to .false.).    tbot = 0, #float, optional     #Soil temperature at the bottom of the soil profile [oC] (omit if     #both lTemp and lChem are equal to .false., set equal to zero if     #kBotT=0).   ampl = 0 #float, optional     #Temperature amplitude at the soil surface [K] (omit if both lTemp     #and lChem are equal to .false.).   )  # Write the input and check if the model simulates ml.write_input() from datetime import datetime start_time = datetime.now() # Run simulation ml.simulate() end_time = datetime.now() print('Duration: {}'.format(end_time - start_time))"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"install-r-package","dir":"Articles","previous_headings":"","what":"Install R Package","title":"Modelling with R","text":"","code":"# Enable this universe options(repos = c(   kwbr = 'https://kwb-r.r-universe.dev',   CRAN = 'https://cloud.r-project.org')) # Install R package install.packages('flextreat.hydrus1d')"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"define-paths","dir":"Articles","previous_headings":"","what":"Define Paths","title":"Modelling with R","text":"","code":"paths_list <- list(   extdata = system.file(\"extdata\", package = \"flextreat.hydrus1d\"),   exe_dir = \"<extdata>/model\",   model_name = \"test\",   model_dir = \"<exe_dir>/<model_name>\",   atmosphere = \"<model_dir>/ATMOSPH.IN\",   a_level = \"<model_dir>/A_LEVEL.out\",   t_level = \"<model_dir>/T_LEVEL.out\",   runinf = \"<model_dir>/Run_Inf.out\",   solute_id = 1,    solute = \"<model_dir>/solute<solute_id>.out\",   soil_data = \"<extdata>/input-data/soil/soil_geolog.csv\" )  paths <- kwb.utils::resolve(paths_list)"},{"path":[]},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"soil","dir":"Articles","previous_headings":"Input Data","what":"Soil","title":"Modelling with R","text":"Soil data derived depth-dependent grain-size analysis soil samples taken Braunschweig. following required input parameters van Genuchten model used HYDRUS1D derived using pedotransfer function ROSETTA-API version 3, developed Zhang Schaap, 2017. Due similar soil characteristics, two different layers (column layer_id) defined: - layer 1: ranging 0 cm - 55 cm depth - layer 2: ranging 55 cm - 210 cm depth spatially aggregation layer (geometric mean) input parameters van Genuchten model performed code shown subsequent table.","code":"library(flextreat.hydrus1d)  soil_dat <- readr::read_csv(paths$soil_data, show_col_types = FALSE) %>%    dplyr::mutate(layer_id = dplyr::if_else(.data$tiefe_cm_ende < 60,                                         1,                                         2),                 thickness_cm = .data$tiefe_cm_ende - .data$tiefe_cm_start,                 sand = .data$S_prozent + .data$G_prozent,                  silt = .data$U_prozent,                  clay = round(100 - .data$sand - .data$silt,                                      1)) %>%    dplyr::mutate(clay = dplyr::if_else(.data$clay < 0,                                       0,                                        .data$clay)) %>%    soilDB:::ROSETTA(vars = c(\"sand\", \"silt\", \"clay\"),                    v = \"3\") %>%    dplyr::mutate(alpha = 10^.data$alpha,                 npar = 10^.data$npar,                  ksat = 10^.data$ksat)   knitr::kable(soil_dat) soil_dat_per_layer <- soil_dat %>%    dplyr::group_by(.data$layer_id) %>%    dplyr::summarise(layer_thickness = max(.data$tiefe_cm_ende) - min(.data$tiefe_cm_start),                    theta_r = sum(.data$theta_r*.data$thickness_cm)/.data$layer_thickness,                    theta_s = sum(.data$theta_s*.data$thickness_cm)/.data$layer_thickness,                    alpha = sum(.data$alpha*.data$thickness_cm)/.data$layer_thickness,                    npar = sum(.data$npar*.data$thickness_cm)/.data$layer_thickness,                    ksat = sum(.data$ksat*.data$thickness_cm)/.data$layer_thickness)   knitr::kable(soil_dat_per_layer)"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"atmospheric-boundary-conditions","dir":"Articles","previous_headings":"Input Data","what":"Atmospheric Boundary Conditions","title":"Modelling with R","text":"total three different atmospheric input boundary conditions (precipitation, potential evaporation irrigation) used within HYDRUS1D model described following subchapters detail.","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"rainfall","dir":"Articles","previous_headings":"Input Data > Atmospheric Boundary Conditions","what":"Rainfall","title":"Modelling with R","text":"Rainfall based historical hourly raw data downloaded DWD open-data ftp server station_id = 662 (.e. Braunschweig). Data aggregated within R daily sums using code :","code":"install.packages(\"rdwd\") library(dplyr) rdwd::updateRdwd()  rdwd::findID(\"Braunschweig\") rdwd::selectDWD(name = \"Braunschweig\", res = \"daily\")  url_bs_rain <- rdwd::selectDWD(name = \"Braunschweig\",                                res = \"hourly\",                                var = \"precipitation\",                                per = \"historical\" )  bs_rain <- rdwd::dataDWD(url_bs_rain)  precipitation_hourly <- rdwd::dataDWD(url_bs_rain) %>%   dplyr::select(.data$MESS_DATUM, .data$R1) %>%   dplyr::rename(\"datetime\" = \"MESS_DATUM\",                 \"precipitation_mm\" = \"R1\")  usethis::use_data(precipitation_hourly)   precipitation_daily <- precipitation_hourly %>%   dplyr::mutate(\"date\" = as.Date(datetime)) %>%   dplyr::group_by(date) %>%   dplyr::summarise(rain_mm = sum(precipitation_mm))  usethis::use_data(precipitation_daily) DT::datatable(head(flextreat.hydrus1d::precipitation_daily))"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"potential-evaporation","dir":"Articles","previous_headings":"Input Data > Atmospheric Boundary Conditions","what":"Potential Evaporation","title":"Modelling with R","text":"based daily potential evaporation grids (1km x 1km) downloaded DWD open-data server, grids (.e. 46) within Abwasserverregnungsgebiet.shp selected spatially aggregated (mean, sd, min, max) using code :","code":"remotes::install_github(\"kwb-r/kwb.dwd@dev\")  shape_file <- system.file(\"extdata/input-data/gis/Abwasserverregnungsgebiet.shp\",                           package = \"flextreat.hydrus1d\")  # Only data of full months can currently be read! evapo_p <- kwb.dwd::read_daily_data_over_shape(   file = shape_file,   variable = \"evapo_p\",   from = \"201701\",   to = \"202012\" )  usethis::use_data(evapo_p) DT::datatable(head(flextreat.hydrus1d::evapo_p))"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"irrigation","dir":"Articles","previous_headings":"Input Data > Atmospheric Boundary Conditions","what":"Irrigation","title":"Modelling with R","text":"Monthly irrigation volumes provided Abwasserverband Braunschweig time period 2017-01-01 - 2020-12-31 csv file separates two sources (groundwater clearwater). Data preparation carried code :","code":"irrigation_file <- system.file(\"extdata/input-data/Beregnungsmengen_AVB.csv\",                           package = \"flextreat.hydrus1d\")   irrigation_area <- rgdal::readOGR(dsn = shape_file)   irrigation <- read.csv2(irrigation_file) %>%   dplyr::select(- .data$Monat) %>%   dplyr::rename(irrigation_m3 = .data$Menge_m3,                 source = .data$Typ,                 month = .data$Monat_num,                 year = .data$Jahr) %>%   dplyr::mutate(date_start = as.Date(sprintf(\"%d-%02d-01\",                                .data$year,                                .data$month)),                 days_in_month = as.numeric(lubridate::days_in_month(.data$date_start)),                 date_end =  as.Date(sprintf(\"%d-%02d-%02d\",                                             .data$year,                                             .data$month,                                             .data$days_in_month)),                 source = kwb.utils::multiSubstitute(.data$source,                                                     replacements = list(\"Grundwasser\" = \"groundwater.mmPerDay\",                                                                         \"Klarwasser\" = \"clearwater.mmPerDay\")),                 irrigation_cbmPerDay = .data$irrigation_m3/.data$days_in_month,                 irrigation_area_sqm = irrigation_area$area,                 irrigation_mmPerDay = 1000*irrigation_cbmPerDay/irrigation_area_sqm) %>%   dplyr::select(.data$year,                 .data$month,                 .data$days_in_month,                 .data$date_start,                 .data$date_end,                 .data$source,                 .data$irrigation_mmPerDay,                 .data$irrigation_area_sqm) %>%   tidyr::pivot_wider(names_from = .data$source,                      values_from = .data$irrigation_mmPerDay)   usethis::use_data(irrigation) DT::datatable(head(flextreat.hydrus1d::irrigation))"},{"path":[]},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"modify-input-files","dir":"Articles","previous_headings":"HYDRUS-1D","what":"Modify Input Files","title":"Modelling with R","text":"model input files initially setup using HYDRUS1D-GUI following modified manually ","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"selector-in","dir":"Articles","previous_headings":"HYDRUS-1D > Modify Input Files","what":"SELECTOR.in","title":"Modelling with R","text":"Soil input data entered manually SELECTOR.two layers defined second table Chapter: Input Data - Soil.","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"atmosphere-in","dir":"Articles","previous_headings":"HYDRUS-1D > Modify Input Files","what":"ATMOSPHERE.in","title":"Modelling with R","text":"Based atmospheric input data (see Chapter: Atmospheric Boundary Conditions) ATMOSPHERE.file HYDRUS1D prepared code starts hydrological summer half year (assumption: soil fully wetted end winter half year): selected time period covers 1278 days (2017-05-01 - 2020-10-30), .e. covers 7 hydrological half years. time-series converted function flextreat.hydrus1d::prepare_atmosphere() data format required HYDRUS1D. Due fact, irrigation rates (.e. sum clearwater.mmPerDay groundwater.mmPerDay) entered separately input column within HYDRUS1D, simply added th prec (.e. precipitation) column. whole time series defined ATMOSPHERE.shown :","code":"atm <- flextreat.hydrus1d::prepare_atmosphere_data() atm_selected <- flextreat.hydrus1d::select_hydrologic_years(atm)   atm_prep <- flextreat.hydrus1d::prepare_atmosphere(   atm_selected,    conc_irrig_clearwater = 1, # use as \"clearwater\" tracer    conc_irrig_groundwater = 0,    conc_rain = 0)  atmos <- kwb.hydrus1d::write_atmosphere(   atm = atm_prep,   MaxAL = nrow(atm_prep),   round_digits = 6 # increase precision for \"clearwater\" tracer!   )  writeLines(atmos, paths$atmosphere) DT::datatable(atm_selected) DT::datatable(atm_prep)"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"run-model","dir":"Articles","previous_headings":"HYDRUS-1D","what":"Run Model","title":"Modelling with R","text":"Finally model run automatically using following code:","code":"exe_path <- kwb.hydrus1d::check_hydrus_exe(dir = paths$exe_dir,                                            skip_preinstalled = TRUE) #> Checking if download of HYDRUS1D executable v4.17.0140 from 'https://github.com/mrustl/hydrus1d/archive/refs/tags/v4.17.0140.zip' was successful ... ok. (0.00s) kwb.hydrus1d:::run_model(exe_path = exe_path,                          model_path = paths$model_dir) #> Warning in shell(cmd = sprintf(\"cd %s && %s\", fs::path_abs(target_dir), : 'cd #> D:/a/_temp/Library/flextreat.hydrus1d/extdata/model && H1D_CALC.exe' execution #> failed with error code 24"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/articles/modelling_r.html","id":"read-results","dir":"Articles","previous_headings":"HYDRUS-1D","what":"Read Results","title":"Modelling with R","text":"","code":"a_level <- kwb.hydrus1d::read_alevel(paths$a_level) a_level #> # A tibble: 1,279 × 10 #>     time sum_r_top sum_r_root sum_v_top sum_v_root sum_v_bot     h_top h_root #>  * <dbl>     <dbl>      <dbl>     <dbl>      <dbl>     <dbl>     <dbl>  <dbl> #>  1     1    0.246           0    0.0699          0  -0.00173 -100000        0 #>  2     2   -0.213           0   -0.389           0  -0.00346     -83.1      0 #>  3     3   -0.0375          0   -0.214           0  -0.00520   -1285.       0 #>  4     4   -0.162           0   -0.338           0  -0.00693    -104.       0 #>  5     5   -0.157           0   -0.333           0  -0.00866    -122.       0 #>  6     6   -0.0311          0   -0.214           0  -0.0104  -100000        0 #>  7     7    0.188           0   -0.178           0  -0.0121  -100000        0 #>  8     8    0.232           0   -0.162           0  -0.0139  -100000        0 #>  9     9    0.408           0   -0.147           0  -0.0156  -100000        0 #> 10    10    0.583           0   -0.136           0  -0.0173  -100000        0 #> # … with 1,269 more rows, and 2 more variables: h_bot <dbl>, a_level <dbl>  t_level <- kwb.hydrus1d::read_tlevel(paths$t_level) t_level #> # A tibble: 17,804 × 22 #>     time r_top r_root  v_top v_root    v_bot sum_r_top sum_r_root sum_v_top #>  * <dbl> <dbl>  <dbl>  <dbl>  <dbl>    <dbl>     <dbl>      <dbl>     <dbl> #>  1 0.111 0.246      0 0.246       0 -0.00173    0.0273          0    0.0273 #>  2 0.148 0.246      0 0.246       0 -0.00173    0.0364          0    0.0364 #>  3 0.164 0.246      0 0.246       0 -0.00173    0.0404          0    0.0404 #>  4 0.171 0.246      0 0.246       0 -0.00173    0.0421          0    0.0421 #>  5 0.180 0.246      0 0.119       0 -0.00173    0.0443          0    0.0432 #>  6 0.189 0.246      0 0.0930      0 -0.00173    0.0465          0    0.0440 #>  7 0.201 0.246      0 0.0904      0 -0.00173    0.0494          0    0.0451 #>  8 0.216 0.246      0 0.0800      0 -0.00173    0.0532          0    0.0463 #>  9 0.236 0.246      0 0.0707      0 -0.00173    0.0581          0    0.0477 #> 10 0.262 0.246      0 0.0540      0 -0.00173    0.0644          0    0.0491 #> # … with 17,794 more rows, and 13 more variables: sum_v_root <dbl>, #> #   sum_v_bot <dbl>, h_top <dbl>, h_root <dbl>, h_bot <dbl>, run_off <dbl>, #> #   sum_run_off <dbl>, volume <dbl>, sum_infil <dbl>, sum_evap <dbl>, #> #   t_level <dbl>, cum_w_trans <dbl>, snow_layer <dbl>  runinf <- kwb.hydrus1d::read_runinf(paths$runinf) runinf #> # A tibble: 17,804 × 11 #>    t_level  time      dt itr_w itr_c it_cum kod_t kod_b converg peclet courant #>  *   <dbl> <dbl>   <dbl> <dbl> <dbl>  <dbl> <dbl> <dbl> <lgl>    <dbl>   <dbl> #>  1       1 0.111 0.111       5     1     25    -4    -5 TRUE       0.1   0.176 #>  2       2 0.148 0.0370      3     1     38    -4    -5 TRUE       0.1   0.073 #>  3       3 0.164 0.0160      3     1     51    -4    -5 TRUE       0.1   0.033 #>  4       4 0.171 0.00695     2     1     63    -4    -5 TRUE       0.1   0.015 #>  5       5 0.180 0.00904     4     1     67    -4    -5 TRUE       0.1   0.011 #>  6       6 0.189 0.00904     3     1     70     4    -5 TRUE       0.1   0.009 #>  7       7 0.201 0.0118      2     1     72     4    -5 TRUE       0.1   0.011 #>  8       8 0.216 0.0153      2     1     74     4    -5 TRUE       0.1   0.012 #>  9       9 0.236 0.0199      2     1     76     4    -5 TRUE       0.1   0.014 #> 10      10 0.262 0.0258      2     1     78     4    -5 TRUE       0.1   0.014 #> # … with 17,794 more rows  solute <- kwb.hydrus1d::read_solute(paths$solute) solute #> # A tibble: 17,804 × 19 #>     time cv_top cv_bot sum_cv_top sum_cv_bot cv_ch0 cv_ch1 c_top c_root c_bot #>  * <dbl>  <dbl>  <dbl>      <dbl>      <dbl>  <dbl>  <dbl> <dbl>  <dbl> <dbl> #>  1 0.111      0      0          0          0      0      0     0      0     0 #>  2 0.148      0      0          0          0      0      0     0      0     0 #>  3 0.164      0      0          0          0      0      0     0      0     0 #>  4 0.171      0      0          0          0      0      0     0      0     0 #>  5 0.180      0      0          0          0      0      0     0      0     0 #>  6 0.189      0      0          0          0      0      0     0      0     0 #>  7 0.201      0      0          0          0      0      0     0      0     0 #>  8 0.216      0      0          0          0      0      0     0      0     0 #>  9 0.236      0      0          0          0      0      0     0      0     0 #> 10 0.262      0      0          0          0      0      0     0      0     0 #> # … with 17,794 more rows, and 9 more variables: cv_root <dbl>, #> #   sum_cv_root <dbl>, sum_cv_n_eql <dbl>, t_level <dbl>, c_gwl <dbl>, #> #   c_run_off <dbl>, sum_c_run_off <dbl>, cv_i <dbl>, sum_cv_i <dbl>"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Rustler. Author, maintainer. . Funder. . Copyright holder.","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Rustler M (2022). flextreat.hydrus1d: R Package Soil Water Balance Solute Transport Modelling Scenarios Project Flextreat. R package version 0.0.0.9000, https://github.com/KWB-R/flextreat.hydrus1d.","code":"@Manual{,   title = {flextreat.hydrus1d: R Package for Soil Water Balance and Solute Transport Modelling Scenarios for Project Flextreat},   author = {Michael Rustler},   year = {2022},   note = {R package version 0.0.0.9000},   url = {https://github.com/KWB-R/flextreat.hydrus1d}, }"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"R Package for Soil Water Balance and Solute Transport Modelling\n    Scenarios for Project Flextreat","text":"details install KWB-R packages checkout installation tutorial.","code":"### Optionally: specify GitHub Personal Access Token (GITHUB_PAT) ### See here why this might be important for you: ### https://kwb-r.github.io/kwb.pkgbuild/articles/install.html#set-your-github_pat  # Sys.setenv(GITHUB_PAT = \"mysecret_access_token\")  # Install package \"remotes\" from CRAN if (! require(\"remotes\")) {   install.packages(\"remotes\", repos = \"https://cloud.r-project.org\") }  # Install KWB package 'flextreat.hydrus1d' from GitHub remotes::install_github(\"KWB-R/flextreat.hydrus1d\")"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Kompetenzzentrum Wasser Berlin gGmbH (KWB) Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/atmosphere.html","id":null,"dir":"Reference","previous_headings":"","what":"Atmosphere — atmosphere","title":"Atmosphere — atmosphere","text":"dummy dataset containing minimum atmospheric data","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/atmosphere.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Atmosphere — atmosphere","text":"","code":"atmosphere"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/atmosphere.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Atmosphere — atmosphere","text":"data frame 12 rows 7 variables: tAtm Time -th data record provided (T) Prec Precipitation rate (LT-1) (absolute value) rSoil Potential evaporation rate (LT-1) (absolute value). rSoil() interpreted KodTop time variable Dirichlet Neumann boundary condition specified. rRoot Potential transpiration rate (LT-1) (absolute value). hCritA Absolute value minimum allowed pressure head soil surface (L).","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/atmosphere.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Atmosphere — atmosphere","text":"https://raw.githubusercontent.com/phydrus/phydrus/dev/examples/phydrus_paper/data/atmosphere.csv/","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/atmosphere.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Atmosphere — atmosphere","text":"","code":"head(atmosphere) #>   tAtm Prec      rSoil      rRoot hCritA #> 1    1 0.51 0.00000000 0.01464508 100000 #> 2    2 0.02 0.00000000 0.01842473 100000 #> 3    3 0.00 0.03394404 0.03132639 100000 #> 4    4 0.00 0.00000000 0.02748290 100000 #> 5    5 0.00 0.03357781 0.02251188 100000 #> 6    6 0.00 0.03713137 0.02779009 100000"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/create_hydrus_exe.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Hydrus1D executable (only on Windows!) — create_hydrus_exe","title":"Create Hydrus1D executable (only on Windows!) — create_hydrus_exe","text":"Create Hydrus1D executable (Windows!)","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/create_hydrus_exe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Hydrus1D executable (only on Windows!) — create_hydrus_exe","text":"","code":"create_hydrus_exe()"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/create_hydrus_exe.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Create Hydrus1D executable (only on Windows!) — create_hydrus_exe","text":"https://github.com/phydrus/source_code/tree/main","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/create_hydrus_exe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Hydrus1D executable (only on Windows!) — create_hydrus_exe","text":"path Hydrus1D v4.0.8 executable","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/create_monthly_atm.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate Atmospheric Data to Monthly Values — create_monthly_atm","title":"Aggregate Atmospheric Data to Monthly Values — create_monthly_atm","text":"Aggregate Atmospheric Data Monthly Values","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/create_monthly_atm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate Atmospheric Data to Monthly Values — create_monthly_atm","text":"","code":"create_monthly_atm(atm = prepare_atmosphere_data())"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/create_monthly_atm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate Atmospheric Data to Monthly Values — create_monthly_atm","text":"atm atm retrieved prepare_atmosphere_data","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/create_monthly_atm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate Atmospheric Data to Monthly Values — create_monthly_atm","text":"tibble yearly atmospheric data values","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/create_monthly_atm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregate Atmospheric Data to Monthly Values — create_monthly_atm","text":"","code":"create_monthly_atm() #> # A tibble: 48 × 5 #>    date_end   rain_mm irrigation_groundwater_… irrigation_clea… potential_evapo… #>    <date>       <dbl>                    <dbl>            <dbl>            <dbl> #>  1 2017-01-31    42.4                  0                    0               8.11 #>  2 2017-02-28    31.7                  0                   17.0            17.3  #>  3 2017-03-31    46.6                  0                   19.2            49.0  #>  4 2017-04-30    24.4                  0                   18.4            60.6  #>  5 2017-05-31    98.1                  0.00145             20.0           101.   #>  6 2017-06-30   114.                   0.0406              27.3           115.   #>  7 2017-07-31   138.                   0.00234             26.8           104.   #>  8 2017-08-31    90.4                  0                   25.2            86.1  #>  9 2017-09-30    52.7                  0                   22.8            44.3  #> 10 2017-10-31    46.1                  0                   21.9            30.1  #> # … with 38 more rows"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/evapo_p.html","id":null,"dir":"Reference","previous_headings":"","what":"Potential Evoporation: Daily — evapo_p","title":"Potential Evoporation: Daily — evapo_p","text":"Median daily potential evaporation irrigation area (.e. ~44km2), based 1x1km2 grids DWD. Downloaded read_daily_data_over_shape 2017-01-01 2020-12-31","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/evapo_p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Potential Evoporation: Daily — evapo_p","text":"","code":"evapo_p"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/evapo_p.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Potential Evoporation: Daily — evapo_p","text":"data.frame 1461 rows 10 variables: file name downloaded grid file source date date year year month month day day mean spatially averaged, mean sd spatially averaged, standard deviation min spatially averaged, min max spatially averaged, max n_values number grid-cells used spatial averaging","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/evapo_p.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Potential Evoporation: Daily — evapo_p","text":"","code":"if (FALSE) { ### Data download remotes::install_github(\"kwb-r/kwb.dwd@dev\") shape_file <- system.file(\"extdata/input-data/gis/Abwasserverregnungsgebiet.shp\", package = \"flextreat.hydrus1d\")  # Only data of full months can currently be read! evapo_p <- kwb.dwd::read_daily_data_over_shape( file = shape_file, variable = \"evapo_p\", from = \"201701\", to = \"202012\" )} head(flextreat.hydrus1d::evapo_p) #>                                       file       date year month day mean sd #> 1 grids_germany_daily_evapo_p_20170101.asc 2017-01-01 2017     1   1  0.2  0 #> 2 grids_germany_daily_evapo_p_20170102.asc 2017-01-02 2017     1   2  0.2  0 #> 3 grids_germany_daily_evapo_p_20170103.asc 2017-01-03 2017     1   3  0.5  0 #> 4 grids_germany_daily_evapo_p_20170104.asc 2017-01-04 2017     1   4  1.1  0 #> 5 grids_germany_daily_evapo_p_20170105.asc 2017-01-05 2017     1   5  0.0  0 #> 6 grids_germany_daily_evapo_p_20170106.asc 2017-01-06 2017     1   6  0.0  0 #>   min max n_values #> 1 0.2 0.2       46 #> 2 0.2 0.2       46 #> 3 0.5 0.5       46 #> 4 1.1 1.1       46 #> 5 0.0 0.0       46 #> 6 0.0 0.0       46"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/irrigation.html","id":null,"dir":"Reference","previous_headings":"","what":"Irrigation: Monthly — irrigation","title":"Irrigation: Monthly — irrigation","text":"Monthly irrigation values provided AVB (cubicmeters) downscaled daily values (dividing \"days_in_month\" normalised mm/squaremeter dividing assumed irrigation area (44111068 m2)","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/irrigation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Irrigation: Monthly — irrigation","text":"","code":"irrigation"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/irrigation.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Irrigation: Monthly — irrigation","text":"data.frame 8835 rows 3 variables: year year month month days_in_month days month date_start date start date_end date end irrigation_area_sqm irrigation area squaremeter \"groundwater.mmPerDay irrigation using \"groundwater\" (mm/sqm) \"clearwater.mmPerDay irrigation using \"clearwater\" (mm/sqm)","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/irrigation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Irrigation: Monthly — irrigation","text":"","code":"if (FALSE) { install.packages(c(\"dplyr\", \"tidyr\")) irrigation_file <- system.file(\"extdata/input-data/Beregnungsmengen_AVB.csv\", package = \"flextreat.hydrus1d\")  irrigation_area <- rgdal::readOGR(dsn = shape_file)  irrigation <- read.csv2(irrigation_file) %>%   dplyr::select(- .data$Monat) %>%   dplyr::rename(irrigation_m3 = .data$Menge_m3,                 source = .data$Typ,                 month = .data$Monat_num,                 year = .data$Jahr) %>%   dplyr::mutate(date_start = as.Date(sprintf(\"%d-%02d-01\",                                              .data$year,                                              .data$month)),                 days_in_month = as.numeric(lubridate::days_in_month(.data$date_start)),                 date_end =  as.Date(sprintf(\"%d-%02d-%02d\",                                             .data$year,                                             .data$month,                                             .data$days_in_month)),                 source = kwb.utils::multiSubstitute(.data$source,                                                     replacements = list(\"Grundwasser\" = \"groundwater.mmPerDay\",                                                                         \"Klarwasser\" = \"clearwater.mmPerDay\")),                 irrigation_cbmPerDay = .data$irrigation_m3/.data$days_in_month,                 irrigation_area_sqm = irrigation_area$area,                 irrigation_mmPerDay = 1000*irrigation_cbmPerDay/irrigation_area_sqm) %>%   dplyr::select(.data$year,                 .data$month,                 .data$days_in_month,                 .data$date_start,                 .data$date_end,                 .data$source,                 .data$irrigation_mmPerDay,                 .data$irrigation_area_sqm) %>%   tidyr::pivot_wider(names_from = .data$source,                      values_from = .data$irrigation_mmPerDay) } head(flextreat.hydrus1d::irrigation) #> # A tibble: 6 × 8 #>    year month days_in_month date_start date_end   irrigation_area_sqm #>   <int> <int>         <dbl> <date>     <date>                   <dbl> #> 1  2017     1            31 2017-01-01 2017-01-31           44111068. #> 2  2017     2            28 2017-02-01 2017-02-28           44111068. #> 3  2017     3            31 2017-03-01 2017-03-31           44111068. #> 4  2017     4            30 2017-04-01 2017-04-30           44111068. #> 5  2017     5            31 2017-05-01 2017-05-31           44111068. #> 6  2017     6            30 2017-06-01 2017-06-30           44111068. #> # … with 2 more variables: groundwater.mmPerDay <dbl>, #> #   clearwater.mmPerDay <dbl>"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/materials.html","id":null,"dir":"Reference","previous_headings":"","what":"Materials — materials","title":"Materials — materials","text":"dataset containing hydraulic soil characteristics Hydrus1D GUI database","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/materials.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Materials — materials","text":"","code":"materials"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/materials.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Materials — materials","text":"data frame 12 rows 7 variables: material_name Name soil Qr Residual soil water content Qs Saturated soil water content Alpha Parameter soil water retention function (L-1, : cm) n Parameter n soil water retention function Ks Saturated hydraulic conductivity (unit: LT-1, : cm/day) Tortuosity parameter conductivity function (-)","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/materials.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Materials — materials","text":"Hydrus1D GUI -> Soil Hydraulic Properties (Pre-Processing Menu, Water Flow Submenu)","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/materials.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Materials — materials","text":"","code":"materials #> # A tibble: 12 × 7 #>    material_name      Qr    Qs Alpha     n     Ks     I #>    <chr>           <dbl> <dbl> <dbl> <dbl>  <dbl> <dbl> #>  1 sand            0.045  0.43 0.145  2.68 713.     0.5 #>  2 loamy sand      0.057  0.41 0.124  2.28 350.     0.5 #>  3 sandy loam      0.065  0.41 0.075  1.89 106.     0.5 #>  4 loam            0.078  0.43 0.036  1.56  25.0    0.5 #>  5 sillt           0.034  0.46 0.016  1.37   6      0.5 #>  6 silt loam       0.067  0.45 0.02   1.41  10.8    0.5 #>  7 sandy clay loam 0.1    0.39 0.059  1.48  31.4    0.5 #>  8 clay loam       0.095  0.41 0.019  1.31   6.24   0.5 #>  9 silty clay loam 0.089  0.43 0.01   1.23   1.68   0.5 #> 10 sandy clay      0.1    0.38 0.027  1.23   2.88   0.5 #> 11 silty clay      0.07   0.36 0.005  1.09   0.48   0.5 #> 12 clay loam       0.068  0.38 0.008  1.09   4.8    0.5"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/plot_monthly_atm.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Monthly Atmospheric Data — plot_monthly_atm","title":"Plot Monthly Atmospheric Data — plot_monthly_atm","text":"Plot Monthly Atmospheric Data","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/plot_monthly_atm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Monthly Atmospheric Data — plot_monthly_atm","text":"","code":"plot_monthly_atm()"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/plot_monthly_atm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Monthly Atmospheric Data — plot_monthly_atm","text":"plot monthly atmospheric data","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/plot_monthly_atm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Monthly Atmospheric Data — plot_monthly_atm","text":"","code":"plot_monthly_atm()"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/precipitation_daily.html","id":null,"dir":"Reference","previous_headings":"","what":"Precipitation: Daily — precipitation_daily","title":"Precipitation: Daily — precipitation_daily","text":"Hourly precipitation data downloaded DWD monitoring station Braunschweig (id = 662) 1997-10-22 2021-12-31, aggregated daily values within R","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/precipitation_daily.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Precipitation: Daily — precipitation_daily","text":"","code":"precipitation_daily"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/precipitation_daily.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Precipitation: Daily — precipitation_daily","text":"data.frame 8835 rows 3 variables: year year month month days_in_month days month date_start date start date_end date end irrigation_area_sqm irrigation area squaremeter \"groundwater.mmPerDay irrigation using \"groundwater\" (mm/sqm) \"clearwater.mmPerDay irrigation using \"clearwater\" (mm/sqm)","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/precipitation_daily.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Precipitation: Daily — precipitation_daily","text":"","code":"if (FALSE) { install.packages(c(\"dplyr\", \"rdwd\")) library(dplyr) rdwd::updateRdwd() rdwd::findID(\"Braunschweig\") rdwd::selectDWD(name = \"Braunschweig\", res = \"daily\")  url_bs_rain <- rdwd::selectDWD(name = \"Braunschweig\",                               res = \"hourly\",                               var = \"precipitation\",                               per = \"historical\" )  bs_rain <- rdwd::dataDWD(url_bs_rain)  precipitation_hourly <- rdwd::dataDWD(url_bs_rain) %>%  dplyr::select(.data$MESS_DATUM, .data$R1) %>%  dplyr::rename(\"datetime\" = \"MESS_DATUM\",                \"precipitation_mm\" = \"R1\")  precipitation_daily <- precipitation_hourly %>%  dplyr::mutate(\"date\" = as.Date(datetime)) %>%  dplyr::group_by(date) %>%  dplyr::summarise(rain_mm = sum(precipitation_mm))  } head(flextreat.hydrus1d::precipitation_daily) #> # A tibble: 6 × 2 #>   date       rain_mm #>   <date>       <dbl> #> 1 1997-10-22     0   #> 2 1997-10-23     0.1 #> 3 1997-10-24     0.5 #> 4 1997-10-25     0.3 #> 5 1997-10-26     0   #> 6 1997-10-27     0"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/precipitation_hourly.html","id":null,"dir":"Reference","previous_headings":"","what":"Precipitation: Hourly — precipitation_hourly","title":"Precipitation: Hourly — precipitation_hourly","text":"Hourly precipitation data downloaded DWD monitoring station Braunschweig (id = 662) 1997-10-22 2021-12-31","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/precipitation_hourly.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Precipitation: Hourly — precipitation_hourly","text":"","code":"precipitation_hourly"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/precipitation_hourly.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Precipitation: Hourly — precipitation_hourly","text":"data.frame 211629 rows 2 variables: datetime date time precipitation_mm precipitation mm","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/precipitation_hourly.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Precipitation: Hourly — precipitation_hourly","text":"","code":"if (FALSE) { install.packages(c(\"dplyr\", \"rdwd\")) library(dplyr) rdwd::updateRdwd() rdwd::findID(\"Braunschweig\") rdwd::selectDWD(name = \"Braunschweig\", res = \"daily\")  url_bs_rain <- rdwd::selectDWD(name = \"Braunschweig\",                               res = \"hourly\",                               var = \"precipitation\",                               per = \"historical\" )  bs_rain <- rdwd::dataDWD(url_bs_rain)  precipitation_hourly <- rdwd::dataDWD(url_bs_rain) %>%  dplyr::select(.data$MESS_DATUM, .data$R1) %>%  dplyr::rename(\"datetime\" = \"MESS_DATUM\",                \"precipitation_mm\" = \"R1\")  } head(flextreat.hydrus1d::precipitation_hourly) #>              datetime precipitation_mm #> 1 1997-10-22 14:00:00                0 #> 2 1997-10-22 17:00:00                0 #> 3 1997-10-22 18:00:00                0 #> 4 1997-10-22 19:00:00                0 #> 5 1997-10-22 20:00:00                0 #> 6 1997-10-22 21:00:00                0"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/prepare_atmosphere.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Atmosphere — prepare_atmosphere","title":"Prepare Atmosphere — prepare_atmosphere","text":"Prepares atmospheric input data structure required HYDRUS1D default uses conservative tracer irrigation source \"clearwater\" ( set 1) order track share cleaned wastewater system inflow rate (\"Prec\" column combined value irrigation using either \"groundwater\" \"clearwater\" real \"rainfall\").","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/prepare_atmosphere.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Atmosphere — prepare_atmosphere","text":"","code":"prepare_atmosphere(   atm,   conc_irrig_clearwater = 100,   conc_irrig_groundwater = 0,   conc_rain = 0,   defaults = kwb.hydrus1d::defaults_atmosphere() )"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/prepare_atmosphere.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Atmosphere — prepare_atmosphere","text":"atm atm retrieved prepare_atmosphere_data conc_irrig_clearwater substance concentration source \"clearwater\" used irrigation (default: 100, set source concentrations default 0 order calculate share \"clearwater\" infiltration groundwater) conc_irrig_groundwater substance concentration source \"groundwater\" used irrigation (default: 0) conc_rain substance concentration rainfall (default: 0) defaults defaults undefined parameterskwb.hydrus1d::defaults_atmosphere()","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/prepare_atmosphere.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Atmosphere — prepare_atmosphere","text":"tibble peoered","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/prepare_atmosphere.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare Atmosphere — prepare_atmosphere","text":"","code":"atm <- prepare_atmosphere_data() atm_selected <- select_hydrologic_years(atm) prepare_atmosphere(atm_selected) #> # A tibble: 1,279 × 14 #>     tAtm   Prec rSoil rRoot hCritA    rB    hB    ht  tTop  tBot  Ampl  cTop #>    <int>  <dbl> <dbl> <int>  <int> <int> <int> <int> <int> <int> <int> <dbl> #>  1     1 0.0645 0.310     0 100000     0     0     0     0     0     0 100.  #>  2     2 0.615  0.155     0 100000     0     0     0     0     0     0  10.5 #>  3     3 0.0645 0.240     0 100000     0     0     0     0     0     0 100.  #>  4     4 0.245  0.12      0 100000     0     0     0     0     0     0  26.4 #>  5     5 0.0745 0.08      0 100000     0     0     0     0     0     0  86.6 #>  6     6 0.0645 0.19      0 100000     0     0     0     0     0     0 100.  #>  7     7 0.0645 0.284     0 100000     0     0     0     0     0     0 100.  #>  8     8 0.105  0.148     0 100000     0     0     0     0     0     0  61.7 #>  9     9 0.0645 0.24      0 100000     0     0     0     0     0     0 100.  #> 10    10 0.0645 0.24      0 100000     0     0     0     0     0     0 100.  #> # … with 1,269 more rows, and 2 more variables: cBot <int>, RootDepth <int>"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/prepare_atmosphere_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Atmospheric Data — prepare_atmosphere_data","title":"Prepare Atmospheric Data — prepare_atmosphere_data","text":"Prepare Atmospheric Data","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/prepare_atmosphere_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Atmospheric Data — prepare_atmosphere_data","text":"","code":"prepare_atmosphere_data()"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/prepare_atmosphere_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Atmospheric Data — prepare_atmosphere_data","text":"data frame atmospheric data Braunschweig","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/prepare_atmosphere_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare Atmospheric Data — prepare_atmosphere_data","text":"","code":"atm <- prepare_atmosphere_data() atm #> # A tibble: 1,461 × 6 #>    date       irrigation_area_sqm groundwater.mmPerDay clearwater.mmPer… rain_mm #>    <date>                   <dbl>                <dbl>             <dbl>   <dbl> #>  1 2017-01-01           44111068.                    0                 0     0   #>  2 2017-01-02           44111068.                    0                 0     1.8 #>  3 2017-01-03           44111068.                    0                 0     3.5 #>  4 2017-01-04           44111068.                    0                 0     9.2 #>  5 2017-01-05           44111068.                    0                 0     0   #>  6 2017-01-06           44111068.                    0                 0     0   #>  7 2017-01-07           44111068.                    0                 0     0.7 #>  8 2017-01-08           44111068.                    0                 0     0.6 #>  9 2017-01-09           44111068.                    0                 0     0   #> 10 2017-01-10           44111068.                    0                 0     0   #> # … with 1,451 more rows, and 1 more variable: evapo_p_mean_mm <dbl>"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/select_hydrologic_years.html","id":null,"dir":"Reference","previous_headings":"","what":"Select hydrologic years — select_hydrologic_years","title":"Select hydrologic years — select_hydrologic_years","text":"Select hydrologic years","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/select_hydrologic_years.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Select hydrologic years — select_hydrologic_years","text":"","code":"select_hydrologic_years(atm = prepare_atmosphere_data())"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/select_hydrologic_years.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Select hydrologic years — select_hydrologic_years","text":"atm atm retrieved prepare_atmosphere_data","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/select_hydrologic_years.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Select hydrologic years — select_hydrologic_years","text":"select hydrologic years","code":""},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/reference/select_hydrologic_years.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Select hydrologic years — select_hydrologic_years","text":"","code":"atm <- prepare_atmosphere_data() atm_selected <- select_hydrologic_years(atm) head(atm_selected) #> # A tibble: 6 × 6 #>   date       irrigation_area_sqm groundwater.mmPerDay clearwater.mmPerD… rain_mm #>   <date>                   <dbl>                <dbl>              <dbl>   <dbl> #> 1 2017-05-01           44111068.            0.0000468              0.645     0   #> 2 2017-05-02           44111068.            0.0000468              0.645     5.5 #> 3 2017-05-03           44111068.            0.0000468              0.645     0   #> 4 2017-05-04           44111068.            0.0000468              0.645     1.8 #> 5 2017-05-05           44111068.            0.0000468              0.645     0.1 #> 6 2017-05-06           44111068.            0.0000468              0.645     0   #> # … with 1 more variable: evapo_p_mean_mm <dbl> tail(atm_selected) #> # A tibble: 6 × 6 #>   date       irrigation_area_sqm groundwater.mmPerDay clearwater.mmPerD… rain_mm #>   <date>                   <dbl>                <dbl>              <dbl>   <dbl> #> 1 2020-10-25           44111068.                    0              0.649     1.2 #> 2 2020-10-26           44111068.                    0              0.649     4.7 #> 3 2020-10-27           44111068.                    0              0.649     0   #> 4 2020-10-28           44111068.                    0              0.649     0   #> 5 2020-10-29           44111068.                    0              0.649     1.5 #> 6 2020-10-30           44111068.                    0              0.649     8.8 #> # … with 1 more variable: evapo_p_mean_mm <dbl>"},{"path":"https://kwb-r.github.io/flextreat.hydrus1d/news/index.html","id":"flextreathydrus1d-0009000","dir":"Changelog","previous_headings":"","what":"flextreat.hydrus1d 0.0.0.9000","title":"flextreat.hydrus1d 0.0.0.9000","text":"Added NEWS.md file track changes package. see https://style.tidyverse.org/news.html writing good NEWS.md","code":""}]
